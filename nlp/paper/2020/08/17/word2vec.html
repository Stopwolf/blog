<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Understanding Word2Vec: Code and Math | Stopwolf’s Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Understanding Word2Vec: Code and Math" />
<meta name="author" content="Siniša Stanivuk" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!" />
<meta property="og:description" content="In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!" />
<link rel="canonical" href="https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html" />
<meta property="og:url" content="https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html" />
<meta property="og:site_name" content="Stopwolf’s Blog" />
<meta property="og:image" content="https://stopwolf.github.io/blog/_notebooks/my_icons/patrick-tomasso-Oaqk7qqNh_c-unsplash.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-17T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Siniša Stanivuk"},"headline":"Understanding Word2Vec: Code and Math","description":"In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!","datePublished":"2020-08-17T00:00:00-05:00","dateModified":"2020-08-17T00:00:00-05:00","image":"https://stopwolf.github.io/blog/_notebooks/my_icons/patrick-tomasso-Oaqk7qqNh_c-unsplash.jpg","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html"},"url":"https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://stopwolf.github.io/blog/feed.xml" title="Stopwolf's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/blog/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Understanding Word2Vec: Code and Math | Stopwolf’s Blog</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Understanding Word2Vec: Code and Math" />
<meta name="author" content="Siniša Stanivuk" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!" />
<meta property="og:description" content="In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!" />
<link rel="canonical" href="https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html" />
<meta property="og:url" content="https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html" />
<meta property="og:site_name" content="Stopwolf’s Blog" />
<meta property="og:image" content="https://stopwolf.github.io/blog/_notebooks/my_icons/patrick-tomasso-Oaqk7qqNh_c-unsplash.jpg" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-08-17T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Siniša Stanivuk"},"headline":"Understanding Word2Vec: Code and Math","description":"In this blog post, we’ll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let’s dive in!","datePublished":"2020-08-17T00:00:00-05:00","dateModified":"2020-08-17T00:00:00-05:00","image":"https://stopwolf.github.io/blog/_notebooks/my_icons/patrick-tomasso-Oaqk7qqNh_c-unsplash.jpg","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html"},"url":"https://stopwolf.github.io/blog/nlp/paper/2020/08/17/word2vec.html","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://stopwolf.github.io/blog/feed.xml" title="Stopwolf's Blog" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
<script type="text/javascript">
require.config({
  paths: {
    jquery: 'https://code.jquery.com/jquery-3.5.0.min',
    plotly: 'https://cdn.plot.ly/plotly-latest.min'
  },

  shim: {
    plotly: {
      deps: ['jquery'],
      exports: 'plotly'
    }
  }
});
</script>

<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head><body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/blog/">Stopwolf&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/about/">About Me</a><a class="page-link" href="/blog/search/">Search</a><a class="page-link" href="/blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Understanding Word2Vec: Code and Math</h1><p class="page-description">In this blog post, we'll get a better understanding of how Word2Vec works. Not only coding it from zero, but also understanding the math behind it. Let's dive in!</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2020-08-17T00:00:00-05:00" itemprop="datePublished">
        Aug 17, 2020
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Siniša Stanivuk</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      13 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/blog/categories/#nlp">nlp</a>
        &nbsp;
      
        <a class="category-tags-link" href="/blog/categories/#paper">paper</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/Stopwolf/blog/tree/master/_notebooks/2020-08-17-word2vec.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/blog/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/Stopwolf/blog/master?filepath=_notebooks%2F2020-08-17-word2vec.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/Stopwolf/blog/blob/master/_notebooks/2020-08-17-word2vec.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/blog/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#One-Hot-Encoded-Vectors">One-Hot Encoded Vectors </a></li>
<li class="toc-entry toc-h2"><a href="#Utility-Functions">Utility Functions </a></li>
<li class="toc-entry toc-h2"><a href="#Training">Training </a></li>
<li class="toc-entry toc-h2"><a href="#Predicting">Predicting </a></li>
<li class="toc-entry toc-h2"><a href="#Going-into-practice">Going into practice </a></li>
<li class="toc-entry toc-h1"><a href="#Conclusion">Conclusion </a></li>
<li class="toc-entry toc-h1"><a href="#References-And-Further-Literature">References And Further Literature </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-17-word2vec.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/blog/images/copied_from_nb/my_icons/patrick-tomasso-Oaqk7qqNh_c-unsplash.jpg" alt="" title="Photo by Patrick Tomasso on Unsplash"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Text, like everything else in one way or another, can be represented with math and numbers. Words can have meaning even if they aren't in the textual form us humans are accustomed to. In order to use words to solve problems computationally, researchers had to redefine that approach. And in comes Word2Vec!</p>
<p>Instead of representing words as boring one-hot encoded vectors using only ones and zeros, we could use Word2Vec model and represent each word by dense vectors. Each vector having multitude of features describing every word in its own way.</p>
<p>Instead of leaving this notebook to collect dust in some folder, I wanted to share it. What makes this blog post different than other word2vec from scratch blog posts, is that I'm fully working out the math part, so you (and I) can better understand what's going on under the hood.</p>
<h2 id="One-Hot-Encoded-Vectors">
<a class="anchor" href="#One-Hot-Encoded-Vectors" aria-hidden="true"><span class="octicon octicon-link"></span></a>One-Hot Encoded Vectors<a class="anchor-link" href="#One-Hot-Encoded-Vectors"> </a>
</h2>
<p>Even though I said that one-hot encoded vectors are boring, they are still used in Word2Vec models. That's why we'll quickly brush over the topic before moving on. OHE vectors consist only of ones and zeros. The vector is mainly consisted of zeros, except for those indexes where some word $w_c$ (corresponding to the said index) is in a window of words of the target word $w_t$. Don't bother with this definition. You'll understand better from the following example.</p>
<p>Example sentence: <code>I like learning everything.</code></p>
<p>Imagine a word $w_t$ was the word <code>I</code> and the window of words is equal to 2. This window is called <i>context</i>. Practically, this means we are looking two words before the word <code>I</code> and two words after it. Since <code>I</code> is the first word, we can only 'see' two words after it. In other words, we can see that the two one-hot encoded vectors corresponding to words <code>like</code> and <code>learning</code> respectively:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>I			[0] [0]
like			[1] [0]
learning		[0] [1]
everything		[0] [0]
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, it's easy to grasp how inefficient this approach would be (memory-wise) if we had thousands or hundreds of thousands of words (some languages have millions) since these vectors are very sparse (they have an extremely low number of non-zero values).<br><br>
That's where researchers stepped in and revolutionized word representation with the Word2Vec model. Word2Vec has two types of models:</p>
<ul>
<li>Continuous Bag of Words model (CBOW)</li>
<li>Skip-gram model
<br><br>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhMAAAFjCAYAAACHaYl4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAETrSURBVHhe7d0HmBX1vcZxk2tyb+7NTbwaY9dYojGJsWJvsStYEEEQlITeRQUV6b1JE0FAuiAiXekoilTpHaUjIFhQShSw3P993p8zew+7s7tnd+bsnvL9PM88uzN79pyzs2dm3vnX4xwAAEAIhAkAABAKYQIAAIRCmAAAAKEQJgAAQCiECQAAEAphAgAAhEKYAAAAoRAmAABAKIQJAAAQCmECAACEQpgAAAChECYAAEAohAkAABAKYQIAAIRCmAAAAKEQJgAAQCiECQAAEAphAgAAhEKYAAAAoRAmAABAKIQJAAAQCmECAACEQpgAAAChECYAAEAohAkAABAKYSJD/fDDD+6bb77x1sL57rvv3NGjR721gonyfURNf9ORI0e8NSBzcH7g+C+ojAgT+jC2b9/erVq1ys2dO9fVrl3b7dixw36mD3qXLl3c8uXL3bx581zFihVdrVq17DF16tRx77zzjvviiy9c06ZN3a5du+x3ZOLEiW7gwIFu6tSp9tgqVaq4smXLupo1a7omTZq4PXv2eI9MjNze648//uh69erlnnjiCfuZ3o++zpkzx35PB8fw4cNd1apVXb169eznkydPtoPWt3//fteqVSu3efNmt2DBgqzX8ZeePXu6w4cP2/5o0aKFvb62N2/e3O3evTvXfaL33KZNG3fw4ME838fnn39u22bOnOm9I+emTJnihgwZ4q0llv53+vurVatmf0fjxo3dRx99ZD/T39C5c+es/aX90KFDB9tP3bp1s/1QoUIFV6lSJfu+b9++tr8qV66ctZ+0L7Zt25br5+qVV14JfC5t//77771HIiqcHzg/xCqq47+gz5Xsx3/GhIlmzZrZCWH27NmuZMmSrmPHjvaBVfrUB3jJkiXu/fffd23bts365+rkUr9+fbd+/Xr31FNPZZ1g5M0333R9+vTx1pz9vg6Wb7/91tuSWLm9171799rJTweeb9GiRe7pp592X331lZs0aZIdKDohyKeffuoaNmxoH2yfHvfcc8+5jRs3ug8++MC1bt06x4dY+1QnirFjx9oJSu9j6NCh9tr+Y7Pvk3Xr1tmBdODAgTzf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saoBrFSyENsAU+ujR4+241iPVelBbmFC23Rzol4hfmmi3+MjO13k/W7puoHQc/mlDdnDhIJObJhQlYcep14aCg76Xa375wjCRHIiTGQA3aWo25eCgU4aChQqloxtn+CHCZ2I/EUHrA58HagqwfCLQUXVG+rmpef0H6+DVyez7CPrxT63ilP9olJ91cGu7brz0MkQQOGphEA9pHQs+selek/oOPNDfPYwodIGHbd6nEo3cgsTan/hD1Snn6v64eDBg/aYICqpVDsKhQmVKuico15heh2NK5NbmFBJhNpW6MZEr6ubFQUdvaaqbAgTyYkwgVAUMNTCW8WPOqgBFD8Fc1U1qNeULuphxLaZ0E2EAkt+Q96relQXfl3U/cHuFDwUJlRKuWzZMtuWG1VvbNmyJav3CJIfYQIAkKugBpj5UY8S9f5QKYaGz1fPjHbt2llJp7p5cuORfggTAIBcqceXShMKOjrt5s2brYpC1Q1+lYuqO1XFgfRDmAAAJIx6dam6Qm2nqLJIX4QJAAAQCmECAACEQpgAAAChECYAAEAohAkAABAKYQIAAIRCmAAAAKEQJgAAQCiECQAAEAphAgAAhEKYAAAAoRAmAABAKIQJAAAQCmECAACEQpgAAAChECYAAEAohAkAABAKYQIAAIRCmAAAAKEQJgAAQCiECQAAEAphAgAAhEKYAAAAoRAmAABAKIQJAAAQCmECAACEQpgAAAChECYAAEAohAkAABAKYQIAAIRCmAAAAKEQJgAAQCiECQAAEAphAgAAhEKYAAAAoRAmAABAKIQJAAAQCmECAACEQpgAAAChECYAAEAohAkAABCCc/8HhJuXXK8IHasAAAAASUVORK5CYII=" alt="w2v_models.png">
<br>
</li>
</ul>
<p>CBOW model is built to predict some target word $w_t$ given words in target word's window, denoted by $w_c$. For example, given words <code>I have __ every day.</code>, the model might predict words like <code>work</code> or <code>classes</code>.<br></p>
<p>Skip-gram on the other hand is the exact opposite of the CBOW model. Skip-gram uses the target word $w_t$ to predict the words in its context, or $w_c$. For example, given word <code>guitar</code>, the model might predict words like <code>electric</code>, <code>play</code>, <code>acoustic</code>, or <code>bass</code>.<br><br>
The actual word representations come from matrices used in these models. Since there exist two of them, we can just take the mean of elements at the same positions and get one matrix. One of the parameters we can set up is the dimension of the final matrix. Its dimensions will be $V\times d$, where $V$ is the number of unique words in our text, or rather the size of the <i>vocabulary</i>, and parameter $d$ represents the dimension of the vector for each word $w_i$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Utility-Functions">
<a class="anchor" href="#Utility-Functions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Utility Functions<a class="anchor-link" href="#Utility-Functions"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Before we begin with the actual word2vec model, we'll create some utility functions for tokenization, creating one-hot encoded (or OHE for short) vectors, and so on...</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The first utility function we're going to cover is  the <code>tokenize</code> function. This function receives some text and extracts all words from it into a list. By using <i>regular expressions</i>, we can create a pattern, which will return an array of all words from the text. 
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>Bellow provided regular expression finds only words, not numbers, and also takes words like "let’s" and "I’m" as one word instead of two.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>

  <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">'[A-Za-z]+[\w^</span><span class="se">\'</span><span class="s1">]*|[\w^</span><span class="se">\'</span><span class="s1">]*[A-Za-z]+[\w^</span><span class="se">\'</span><span class="s1">]*'</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">pattern</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>mapping</code> function creates a vocabulary of unique words and pairs them with numbers for easier manipulation. That's why we're using dictionaries mapping words to numbers, but also numbers to words. Since we can't get keys by the values of a dictionary, we'll need both dictionaries in the future.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">mapping</span><span class="p">(</span><span class="n">text_array</span><span class="p">):</span>

  <span class="n">idx_to_word</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="n">word_to_idx</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text_array</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">idx_to_word</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
      <span class="n">idx_to_word</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span>
      <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
      
    
    <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">word_to_idx</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="n">word_to_idx</span><span class="p">[</span><span class="n">word</span><span class="p">]</span> <span class="o">=</span> <span class="n">j</span>
      <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
      

  <span class="k">return</span> <span class="n">idx_to_word</span><span class="p">,</span> <span class="n">word_to_idx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lastly comes the function for creating OHE vectors. We need to provide tokenized text, dictionary of words to numbers and window size, or rather the context size.<br>
Given those, the output will be an array of pairs of OHE vectors. One pair is consisting of OHE vector for $w_t$ (center word), and OHE vectors for $w_c$, one OHE vector for every word in $w_t$'s context.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">one_hot_encoding</span><span class="p">(</span><span class="n">text_array</span><span class="p">,</span> <span class="n">word_to_idx</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>

  <span class="n">matrix</span> <span class="o">=</span> <span class="p">[]</span>

  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">text_array</span><span class="p">):</span>
    
    <span class="n">center_vec</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">word_to_idx</span><span class="p">]</span>
    <span class="n">center_vec</span><span class="p">[</span><span class="n">word_to_idx</span><span class="p">[</span><span class="n">word</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>


    <span class="n">context_vec</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">window_size</span><span class="p">,</span> <span class="n">window_size</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      
      <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">idx</span><span class="o">+</span><span class="n">i</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">idx</span><span class="o">+</span><span class="n">i</span> <span class="o">&gt;=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_array</span><span class="p">)</span> <span class="ow">or</span> <span class="n">word</span> <span class="o">==</span> <span class="n">text_array</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="n">i</span><span class="p">]:</span>
        <span class="k">continue</span>
      
      <span class="n">temp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">word_to_idx</span><span class="p">]</span>
      <span class="n">temp</span><span class="p">[</span><span class="n">word_to_idx</span><span class="p">[</span><span class="n">text_array</span><span class="p">[</span><span class="n">idx</span><span class="o">+</span><span class="n">i</span><span class="p">]]]</span> <span class="o">=</span> <span class="mi">1</span> 

      <span class="n">context_vec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
      
    <span class="n">matrix</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">center_vec</span><span class="p">,</span> <span class="n">context_vec</span><span class="p">])</span>
    

  <span class="k">return</span> <span class="n">matrix</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Training">
<a class="anchor" href="#Training" aria-hidden="true"><span class="octicon octicon-link"></span></a>Training<a class="anchor-link" href="#Training"> </a>
</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since the actual final output of forward pass is the softmax function applied to vector $u$, we'll first define the softmax function as:

$$ \frac{exp(u_j)}{\sum_{j'=1}^V exp(u_{j'})}, \forall \ u_j \in \ u$$

By using the softmax function, we transform plain numbers of our output vector $u$ into some probability distribution $p$. That way, we can easily extract words with the highest probabilities of being in a context for $w_t$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">softmax</span><span class="p">(</span><span class="n">u</span><span class="p">):</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">u_j</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">u</span><span class="p">))</span> <span class="k">for</span> <span class="n">u_j</span> <span class="ow">in</span> <span class="n">u</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The forward pass is very simple. It's comprised of a couple of matrix multiplications and softmax function at the end.<br><br>
<img src="data:image/png;base64,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" alt="forward_pass.PNG"></p>
<p>Above is an annotated picture from the paper, so we can better grasp the locations of each variable and why each equation is the way it is.</p>
<p>We can imagine word $w_t$ passing through our model and through following equations:<br>

$$ h = w_t^{T} \times w_1$$


$$ u = h \times w_2$$

and finally:

$$ y = \mathcal {S}oftmax(u) $$
</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">forward_pass</span><span class="p">(</span><span class="n">wt</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">):</span>

  <span class="n">wt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">wt</span><span class="p">)</span>

  <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">wt</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">w1</span><span class="p">)</span>

  <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>
  
  <span class="k">return</span> <span class="n">softmax</span><span class="p">(</span><span class="n">u</span><span class="p">),</span> <span class="n">h</span><span class="p">,</span> <span class="n">u</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's now work our way through the loss function so we can create a function which calculates it: $$ L = -logP(w_1,..., w_C|w_t) = \\ -log{\displaystyle \prod_{c=1}^{C} \frac{exp(u_{c,j^*_c})}{\sum_{j'=1}^V exp(u_{j'})}} = \\  - \sum_{c=1}^C log \frac{exp(u_{j^*_c})}{\sum_{j'=1}^V exp(u_{j'})} = \\-\sum_{c=1}^C(u_{j^*_c} - log \sum_{j'=1}^V exp(u_{j'})) = \\ - \sum_{c=1}^C u_{j^*_c} + \sum_{c=1}^C (log \sum_{j'=1}^V exp(u_{j'})) = \\ - \sum_{c=1}^C u_{j^*_c} + C log \sum_{j'=1}^V exp(u_{j'})$$ <br>
The loss function is calculated for every word and after each epoch. $C$ denotes the number of <i>context</i> words for some particular target word. Vector $u$ denotes the output of the forward pass, before the softmax function is applied, which further indicates that $u_{j^*_c}$ is a concrete number in that vector corresponding to the $c$-th context word. <br>
Bellow, you can have a look at how we calculate the loss function:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">w_c</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
  <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">u</span><span class="p">[</span><span class="n">word</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">w_c</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">w_c</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">u</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We are taking <code>u[word.index(1)]</code> because our vector <code>word</code> is a one-hot encoded vector, that is, we're taking the index of that OHE vector where its value is equal to 1 (that gives us the $j_c^*$-th index).</p>
<p>Before we jump to backpropagation, we need to calculate the error the model makes. But why, and how do we do that?</p>
<p>We calculate the error because the error propagates back through the model and that's ultimately how the model learns. When it comes to "how", we derive the loss function with respect to every word in the context.
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>We aren’t deriving $L = -logP(w_1,..., w_C|w_t)$ but rather loss for one specific word $L = -logP(w_c|w_t)$ like follows:
</div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$ \frac{\partial L}{\partial u_{c,j}} = \frac{\partial}{\partial u_{c,j}} (-  u_{j_c}) + \frac{\partial}{\partial u_{c,j}} log\sum_{j'=1}^V exp(u_{j'}) = \\ -t_{c,j} + \frac{1}{\sum_{j'=1}^V exp(u_{j'})} \frac{\partial}{\partial u_{c,j}} (\sum_{j'=1}^V exp(u_{j'})) = \\ - t_{c,j} + \frac{1}{\sum_{j'=1}^V exp(u_{j'})}(0 + ...+ \frac{\partial}{\partial u_{c,j}} exp(u_{c, j}) + ... + 0) = \\
\frac{exp(u_{c,j})}{\sum_{j'=1}^V exp(u_{j'})} - t_{c,j} = y_{c,j} - t_{c,j}$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$t_{c,j}$ is OHE vector that represents some word $c$ which has value 1 at $j$-th index; $y_{c,j}$ is $j$-th value of a softmax output of the model for a word $c$.
You can look at this as the difference between the model's output and the expected output.</p>
<p>Now, we sum those errors and calculate the error like so:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">error</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">w_c</span><span class="p">):</span>
  <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span> 
  <span class="n">w_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">w_c</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">w_c</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we calculated the error, we need to propagate it back through the model.</p>
<p>Firstly, we calculate the update for $w_2$ matrix:

$$ \frac{\partial L}{\partial w_2} = \sum_{c=1}^C \frac{\partial L}{\partial u_{c,j}} \frac{\partial u_{c,j}}{\partial w_2} = E \cdot h = dw_2$$

This is because $u = h \times w_2$ and we already calculated the error from $\frac{\partial L}{\partial u_{c,j}}$.</p>
<p>Before we proceed to the update for $w_1$ matrix, we need to calculate the following derivative (which is similar to the previous equation):

$$ \frac{\partial L}{\partial h} = \sum_{j=1}^V \frac{\partial L}{\partial u_{c,j}} \frac{\partial u_{c.j}}{\partial h} = E \cdot w_2 = EH$$
</p>
<p>Now, we can calculate $dw_1$:

$$ \frac{\partial L}{\partial w_1} = \frac{\partial L}{\partial h} \frac{\partial h}{\partial w_1} = EH \cdot w_t = dw_1$$

This is because $h = w_t^T \times w_1$.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
  <span class="n">err</span> <span class="o">=</span> <span class="n">error</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

  <span class="n">dw2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
  <span class="n">EH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">err</span><span class="p">,</span> <span class="n">w2</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
  <span class="n">dw1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">EH</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">dw1</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">dw2</span><span class="o">.</span><span class="n">T</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The actual part where the model learns to update its weights is defined in the following equation. Mathematically, this is done as:

$$ w_1^{new} = w_1^{old} - l_r \nabla w_1$$

and same for the second set of weights:

$$ w_2^{new} = w_2^{old} - l_r \nabla w_2$$
</p>
<p>$\nabla$ (nabla) sign is just a sign for gradient which is why this learning process is called <i>gradient descent</i>.</p>
<p>In our code, we can use $dw_i$ instead of $\nabla w_i$, since they're one in the same.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">learning</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">dw1</span><span class="p">,</span> <span class="n">dw2</span><span class="p">,</span> <span class="n">lr</span><span class="p">):</span>
  <span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">dw1</span><span class="p">))</span>
  <span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">w2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span> <span class="n">dw2</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, in the <code>train</code> method, we collect everything previously done into one function. We initialize weights with random uniform distribution ${\mathcal {U}}(-1, 1)$. Since these numbers may be too large, we multiply them with 0.01.</p>
<p>In every epoch, for every word, we perform forward pass, backpropagation, and then update weights and calculate the loss. <code>history</code> is set up as a way to monitor (and later plot) losses as the model goes through each epoch. This is mainly done to check if the model is learning something or not.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">words</span><span class="p">,</span> <span class="n">vocab</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="n">dim</span><span class="p">):</span>

  <span class="n">w1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">),</span> <span class="n">dim</span><span class="p">))</span> <span class="o">*</span> <span class="mf">0.01</span>
  <span class="n">w2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vocab</span><span class="p">)))</span> <span class="o">*</span> <span class="mf">0.01</span>

  <span class="n">history</span> <span class="o">=</span> <span class="p">{}</span>
  <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>

    <span class="n">l</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
      <span class="n">out</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <span class="n">forward_pass</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>
      <span class="n">dw1</span><span class="p">,</span> <span class="n">dw2</span> <span class="o">=</span> <span class="n">backprop</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">word</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
      <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span> <span class="o">=</span> <span class="n">learning</span><span class="p">(</span><span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">dw1</span><span class="p">,</span> <span class="n">dw2</span><span class="p">,</span> <span class="n">lr</span><span class="p">)</span>

      <span class="n">l</span> <span class="o">+=</span> <span class="n">loss</span><span class="p">(</span><span class="n">word</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">u</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">e</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">history</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">l</span>
  
  <span class="k">return</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">history</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Predicting">
<a class="anchor" href="#Predicting" aria-hidden="true"><span class="octicon octicon-link"></span></a>Predicting<a class="anchor-link" href="#Predicting"> </a>
</h2>
<p>Predicting is nothing more than a forward pass through the model for some target word and then returning the most likely ones to be in its context. 
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>We can’t provide a word the model wasn’t trained on, no matter how similar or synonymous the word is to those words we did train our model on.
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">word</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">matrix</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">indices</span><span class="p">):</span>
  <span class="n">word</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
  <span class="n">out</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">forward_pass</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">words</span><span class="p">[</span><span class="n">word</span><span class="p">]][</span><span class="mi">0</span><span class="p">],</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">)</span>

  <span class="n">most_likely_idxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">out</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[</span><span class="o">-</span><span class="mi">4</span><span class="p">:][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
  <span class="k">return</span> <span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">most_likely_idxs</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Going-into-practice">
<a class="anchor" href="#Going-into-practice" aria-hidden="true"><span class="octicon octicon-link"></span></a>Going into practice<a class="anchor-link" href="#Going-into-practice"> </a>
</h2>
<p>Let's test our Word2Vec model and see how everything works. We'll take a random sentence as an example to train the model on.</p>
<p>All this is done in couple of steps:</p>
<ol>
<li>Tokenize the text</li>
<li>Map tokens to numbers</li>
<li>Create appropriate OHE vectors</li>
<li>Train the model</li>
</ol>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="s1">'I like reading The Witcher books every night, but I only have one left in the series.'</span>

<span class="n">tokens</span> <span class="o">=</span> <span class="n">tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
<span class="n">idxs</span><span class="p">,</span> <span class="n">words</span> <span class="o">=</span> <span class="n">mapping</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
<span class="n">mat</span> <span class="o">=</span> <span class="n">one_hot_encoding</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">window_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">history</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">mat</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll plot the loss function over epochs during training to see if the model learned got better over time at predicting the context words given the target words.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> <span class="nb">list</span><span class="p">(</span><span class="n">history</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="n">color</span><span class="o">=</span><span class="s1">'red'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Numer of epochs'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Loss'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, 'Loss')</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And it did! The loss was reducing at rapid speed, and then plateaued (or reached the point of no big changes in learning).</p>
<p>We can also have a look at our embeddings, or word representations, which may be the main result of this lesson. You can think of each row as one word from our example sentence, and each column as a feature.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[ 0.47  , -1.7471,  0.1557,  0.4786,  1.4846],
       [-0.9634, -1.435 , -0.2449, -0.2901, -0.0538],
       [-1.4122, -1.4743, -0.4483, -0.204 , -0.1574],
       [-1.117 ,  0.2088, -0.9444, -1.2663, -1.1992],
       [-1.9791,  0.51  , -0.4437, -0.3276,  0.5801],
       [-1.7116,  0.9246,  0.2479, -0.6965,  0.9689],
       [-1.4144,  1.4498,  0.3125,  0.2373,  1.2433],
       [-0.6107,  0.2046,  0.8176, -0.0828,  2.0107],
       [ 0.1517,  0.8335,  1.1067,  0.9358,  1.9614],
       [ 1.565 , -0.3988,  1.1101,  1.2965,  0.6315],
       [ 1.9103, -0.4376, -0.0585,  0.3374, -0.311 ],
       [ 2.0972, -0.3943,  0.3935,  0.3768, -0.918 ],
       [ 1.2966,  0.0654, -0.6747, -0.2323, -1.4494],
       [ 1.3057, -0.0296, -0.8275, -0.7703, -1.7792],
       [ 0.2715,  0.2859, -0.9785, -1.126 , -1.8184]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The prediction part of the model shouldn't be forgotten either. If we predict context words of the word <code>Witcher</code> for example, we'll get the following most likely context words:
</p>
<div class="flash">
    <svg class="octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info octicon octicon-info" viewbox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 01-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 01-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg>
    <strong>Note: </strong>Example sentence was: <code>I like reading The Witcher books every night, but I only have one left in the series.</code>
</div>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">predict</span><span class="p">(</span><span class="s1">'Witcher'</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="n">w2</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">idxs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>['the', 'books', 'reading', 'every']</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h1>
<p>Working with words was inefficient and slow. One-hot encoded vectors were an easy and quick solution but included no intuitiveness or creativity. Until Word2Vec appeared as a seemingly simple solution which was its own revolution. It changed how we observe, process, and work with words and texts in general. <br><br></p>
<hr>
<p><br></p>
<p>Thank you for reading up to here!<br>
This was mainly made as a reminder and a practice for me, but if this helped you, feel free to share or comment to let me know your thoughts!</p>
<p>If you find any mistakes I made, notify me and I'll make the necessary changes and mention you and your help. Any and all suggestions and constructive criticism are always welcome. We're all here to learn!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References-And-Further-Literature">
<a class="anchor" href="#References-And-Further-Literature" aria-hidden="true"><span class="octicon octicon-link"></span></a>References And Further Literature<a class="anchor-link" href="#References-And-Further-Literature"> </a>
</h1>
<p>[1]   <a href="https://arxiv.org/pdf/1301.3781.pdf"> T. Mikolov, K. Chen, G. Corrado, and J. Dean. Efficient estimation of word representations
in vector space. ICLR Workshop, 2013.</a><br>
[2]   <a href="https://arxiv.org/pdf/1310.4546.pdf">T. Mikolov, I. Sutskever, K. Chen, G. Corrado, and J. Dean. Distributed Representations of
Words and Phrases and their Compositionality. Accepted to NIPS 2013.</a><br>
[3] <a href="https://arxiv.org/pdf/1411.2738.pdf">X. Rong. word2vec Parameter Learning Explained. ArXiv 2014.</a></p>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="Stopwolf/blog"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/blog/nlp/paper/2020/08/17/word2vec.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Platform I use to share things I learned. Mostly Machine Learning, Data Science etc.</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/Stopwolf" title="Stopwolf"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/TheStopwolf" title="TheStopwolf"><svg class="svg-icon grey"><use xlink:href="/blog/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
